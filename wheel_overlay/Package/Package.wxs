<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Wheel Overlay" Manufacturer="OBRL" Version="0.2.0.0" UpgradeCode="19d19028-090f-4888-912b-650058e100f7">
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    
    <MediaTemplate EmbedCab="yes" />

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="WheelOverlay" />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Wheel Overlay" />
    </StandardDirectory>

    <Icon Id="AppIcon" SourceFile="..\WheelOverlay\app.ico"/>
    <Property Id="ARPPRODUCTICON" Value="AppIcon" />

    <Feature Id="Main">
      <ComponentGroupRef Id="AppComponents" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>
  </Package>

  <!-- This component group will be populated by the build process or manually defined for the main exe -->
  <Fragment>
    <ComponentGroup Id="AppComponents" Directory="INSTALLFOLDER">
      <Component Id="MainExecutable">
        <File Source="WheelOverlay.exe" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="e8369302-3932-491c-8f43-855f93976375">
        <Shortcut Id="ApplicationStartMenuShortcut" 
                  Name="Wheel Overlay" 
                  Description="Wheel Overlay Tool"
                  Target="[INSTALLFOLDER]WheelOverlay.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon"/>
        <RemoveFolder Id="CleanUpShortCut" Directory="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\OBRL\WheelOverlay" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
